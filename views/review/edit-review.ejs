<!-- views/review/edit-review.ejs -->

<% if (title) { %>
  <h1><%= title %></h1>
<% } else { %>
  <%- redirect('/') %>
<% } %>

<!-- Flash messages & server-side errors -->
<%- messages() %>
<% if (errors && errors.length > 0) { %>
  <ul class="notice error-list">
    <% errors.forEach(error => { %>
      <li><%= error.msg || error %></li>
    <% }) %>
  </ul>
<% } %>

<div class="container">
  <div class="edit-review-container">
    <form 
      id="updateReviewForm" 
      class="form-container" 
      action="/review/update-review" 
      method="POST"
    >
      <!-- Review Date (readonly) -->
      <div class="form-group">
        <label for="review_date">Review Date</label>
        <input
          type="text"
          id="review_date"
          name="review_date"
          value="<%= locals.review_date || '' %>"
          readonly
          class="readonly-input"
        />
      </div>

      <!-- Review Text -->
      <div class="form-group">
        <label for="review_text">Review Comment <span class="required">*</span></label>
        <textarea
          id="review_text"
          name="review_text"
          rows="8"
          placeholder="Share your thoughts about this vehicle..."
          title="Please enter your review (minimum 10 characters)"
          required
          minlength="10"
          maxlength="1000"
        ><%= locals.review_text || '' %></textarea>
      </div>

      <!-- Hidden fields -->
      <input type="hidden" name="review_id" value="<%= locals.review_id || '' %>">

      <!-- If using CSRF (common in Node/Express apps with csurf or similar) -->
      <!-- <input type="hidden" name="_csrf" value="<%= csrfToken %>"> -->

      <!-- Submit button (will be enabled by JS) -->
      <div class="form-actions">
        <button 
          type="submit" 
          id="submitReviewBtn" 
          disabled
        >
          Update Review
        </button>
        <a href="/account/" class="btn-secondary">Cancel</a>
      </div>
    </form>
  </div>
</div>

<script src="/js/review-update.js"></script>